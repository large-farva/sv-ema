//@version=5
indicator("Triple EMA (3-in-1) with Alerts", shorttitle="3xEMA+", overlay=true)

// ───────────────────────────────
// INPUTS
// ───────────────────────────────

// EMA 1 Settings
show_ema1   = input.bool(true, "Show EMA 1", group="EMA 1 Settings")
ema1_length = input.int(8, "Length", minval=1, group="EMA 1 Settings")
ema1_color  = input.color(color.new(color.aqua, 0), "Color", group="EMA 1 Settings")

// EMA 2 Settings
show_ema2   = input.bool(true, "Show EMA 2", group="EMA 2 Settings")
ema2_length = input.int(13, "Length", minval=1, group="EMA 2 Settings")
ema2_color  = input.color(color.new(color.blue, 0), "Color", group="EMA 2 Settings")

// EMA 3 Settings
show_ema3   = input.bool(true, "Show EMA 3", group="EMA 3 Settings")
ema3_length = input.int(200, "Length", minval=1, group="EMA 3 Settings")
ema3_color  = input.color(color.new(color.white, 0), "Color", group="EMA 3 Settings")

// Source
src = input.source(close, "Source", group="General Settings", tooltip="Select the price source for EMA calculations (e.g., close, open, hl2, etc.)")

// ───────────────────────────────
// CALCULATIONS
// ───────────────────────────────
ema1 = ta.ema(src, ema1_length)
ema2 = ta.ema(src, ema2_length)
ema3 = ta.ema(src, ema3_length)

// ───────────────────────────────
// PLOT EMAs (Conditional)
// ───────────────────────────────
plot(show_ema1 ? ema1 : na, color=ema1_color, linewidth=2, title="EMA 1")
plot(show_ema2 ? ema2 : na, color=ema2_color, linewidth=2, title="EMA 2")
plot(show_ema3 ? ema3 : na, color=ema3_color, linewidth=2, title="EMA 3")

// ───────────────────────────────
// ALERTS & LABELS
// ───────────────────────────────
ema1_cross_ema2_up   = ta.crossover(ema1, ema2)
ema1_cross_ema2_down = ta.crossunder(ema1, ema2)
ema2_cross_ema3_up   = ta.crossover(ema2, ema3)
ema2_cross_ema3_down = ta.crossunder(ema2, ema3)

// Alerts
alertcondition(ema1_cross_ema2_up,   title="EMA1 crosses above EMA2", message="EMA1 crossed above EMA2 — potential bullish momentum")
alertcondition(ema1_cross_ema2_down, title="EMA1 crosses below EMA2", message="EMA1 crossed below EMA2 — potential bearish momentum")
alertcondition(ema2_cross_ema3_up,   title="EMA2 crosses above EMA3", message="EMA2 crossed above EMA3 — possible trend continuation")
alertcondition(ema2_cross_ema3_down, title="EMA2 crosses below EMA3", message="EMA2 crossed below EMA3 — possible trend weakening")

// ───────────────────────────────
// ON-CHART LABELS (Conditionally Displayed)
// ───────────────────────────────
if show_ema1 and show_ema2
    if ema1_cross_ema2_up
        label.new(bar_index, ema1, "EMA1↑EMA2", style=label.style_label_up, color=color.new(color.green, 0), textcolor=color.white, size=size.tiny)
    if ema1_cross_ema2_down
        label.new(bar_index, ema1, "EMA1↓EMA2", style=label.style_label_down, color=color.new(color.red, 0), textcolor=color.white, size=size.tiny)

if show_ema2 and show_ema3
    if ema2_cross_ema3_up
        label.new(bar_index, ema2, "EMA2↑EMA3", style=label.style_label_up, color=color.new(color.lime, 20), textcolor=color.white, size=size.tiny)
    if ema2_cross_ema3_down
        label.new(bar_index, ema2, "EMA2↓EMA3", style=label.style_label_down, color=color.new(color.maroon, 20), textcolor=color.white, size=size.tiny)
